<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Corre√ß√µes do Drag and Drop</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8f9fa;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .test-header {
            background: #f1f5f9;
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .test-header h1 {
            margin: 0;
            color: #1e293b;
            font-size: 24px;
        }
        
        .test-content {
            padding: 20px;
        }
        
        .test-section {
            margin-bottom: 30px;
        }
        
        .test-section h2 {
            color: #475569;
            font-size: 18px;
            margin-bottom: 15px;
        }
        
        .test-info {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .test-info h3 {
            margin: 0 0 10px 0;
            color: #1e293b;
            font-size: 16px;
        }
        
        .test-info ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .test-info li {
            margin-bottom: 5px;
            color: #475569;
        }
        
        .test-button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .test-button:hover {
            background: #2563eb;
        }
        
        .test-button.secondary {
            background: #64748b;
        }
        
        .test-button.secondary:hover {
            background: #475569;
        }
        
        .status-indicator {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            margin-left: 10px;
        }
        
        .status-success {
            background: #d1fae5;
            color: #065f46;
        }
        
        .status-warning {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-error {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .fix-highlight {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 6px 6px 0;
        }
        
        .fix-highlight h4 {
            margin: 0 0 10px 0;
            color: #92400e;
        }
        
        .fix-highlight p {
            margin: 0;
            color: #92400e;
        }
        
        .debug-section {
            background: #f1f5f9;
            border: 1px solid #cbd5e1;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .debug-section h4 {
            margin: 0 0 10px 0;
            color: #334155;
        }
        
        .debug-code {
            background: #1e293b;
            color: #e2e8f0;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>üîß Teste - Corre√ß√µes do Drag and Drop</h1>
        </div>
        
        <div class="test-content">
            <div class="test-section">
                <h2>Problema Identificado</h2>
                
                <div class="fix-highlight">
                    <h4>üö® Problema: Ordens nas Colunas de T√©cnicos N√£o Podem Ser Selecionadas</h4>
                    <p><strong>Sintoma:</strong> Ao clicar nas ordens de servi√ßo nas colunas de t√©cnicos, a tela se move mas nada √© selecionado para arrastar de volta para a coluna "Em aberto".</p>
                    <p><strong>Causa:</strong> As ordens nas colunas de t√©cnicos n√£o estavam sendo selecionadas corretamente no sistema de drag and drop.</p>
                </div>
            </div>
            
            <div class="test-section">
                <h2>Corre√ß√µes Implementadas</h2>
                
                <div class="test-info">
                    <h3>‚úÖ 1. Sele√ß√£o de Ordens nas Colunas de T√©cnicos</h3>
                    <ul>
                        <li>Adicionada l√≥gica para selecionar ordens quando o drag √© iniciado</li>
                        <li>Implementada verifica√ß√£o se a ordem j√° est√° selecionada</li>
                        <li>Adicionada classe CSS <code>selected</code> para feedback visual</li>
                        <li>Logs de debug adicionados para rastrear o processo</li>
                    </ul>
                </div>
                
                <div class="test-info">
                    <h3>‚úÖ 2. Feedback Visual de Sele√ß√£o</h3>
                    <ul>
                        <li>Estilos CSS adicionados para ordens selecionadas</li>
                        <li>Borda azul √† esquerda para indicar sele√ß√£o</li>
                        <li>Fundo azul claro para destacar a sele√ß√£o</li>
                        <li>Hover state diferenciado para ordens selecionadas</li>
                    </ul>
                </div>
                
                <div class="test-info">
                    <h3>‚úÖ 3. Logs de Debug</h3>
                    <ul>
                        <li>Logs adicionados no <code>onDragStart</code> das ordens</li>
                        <li>Logs adicionados no <code>onDrop</code> da coluna "Em aberto"</li>
                        <li>Logs adicionados na fun√ß√£o <code>handleReturnToOpen</code></li>
                        <li>Rastreamento completo do fluxo de drag and drop</li>
                    </ul>
                </div>
            </div>
            
            <div class="test-section">
                <h2>C√≥digo Implementado</h2>
                
                <div class="debug-section">
                    <h4>üîß Sele√ß√£o de Ordens nas Colunas de T√©cnicos</h4>
                    <div class="debug-code">
// Antes:
&lt;div 
  className="technician-order-row"
  onClick={() => handleOrderClick(ordem)}
  draggable
  onDragStart={(e) => {
    e.dataTransfer.setData('orderId', ordem.id);
    e.dataTransfer.setData('fromTechnician', 'true');
  }}
&gt;

// Depois:
&lt;div 
  className={`technician-order-row ${selectedOrders.includes(ordem.id) ? 'selected' : ''}`}
  onClick={() => handleOrderClick(ordem)}
  draggable
  onDragStart={(e) => {
    console.log(`üîÑ Iniciando drag da ordem ${ordem.id} das colunas de t√©cnicos`);
    if (!selectedOrders.includes(ordem.id)) {
      console.log(`‚úÖ Selecionando ordem ${ordem.id} para drag`);
      setSelectedOrders([ordem.id]);
    }
    e.dataTransfer.setData('orderId', ordem.id);
    e.dataTransfer.setData('fromTechnician', 'true');
    console.log(`üìã Dados de transfer√™ncia definidos: orderId=${ordem.id}, fromTechnician=true`);
  }}
&gt;
                    </div>
                </div>
                
                <div class="debug-section">
                    <h4>üîß CSS para Feedback Visual</h4>
                    <div class="debug-code">
.technician-order-row.selected {
  background: #e3f2fd;
  border-left: 3px solid #2196f3;
}

.technician-order-row.selected:hover {
  background: #bbdefb;
}
                    </div>
                </div>
                
                <div class="debug-section">
                    <h4>üîß Logs de Debug no Drop</h4>
                    <div class="debug-code">
onDrop={(e) => {
  e.preventDefault();
  console.log(`üéØ Drop detectado na coluna "Em aberto"`);
  const orderId = e.dataTransfer.getData('orderId');
  const fromTechnician = e.dataTransfer.getData('fromTechnician');
  console.log(`üìã Dados recebidos: orderId=${orderId}, fromTechnician=${fromTechnician}`);
  
  if (fromTechnician === 'true' && orderId) {
    console.log(`‚úÖ Chamando handleReturnToOpen para ordem ${orderId}`);
    handleReturnToOpen(orderId);
  } else {
    console.log(`‚ùå Drop ignorado: fromTechnician=${fromTechnician}, orderId=${orderId}`);
  }
  setIsDragOverOpen(false);
}}
                    </div>
                </div>
            </div>
            
            <div class="test-section">
                <h2>Como Testar as Corre√ß√µes</h2>
                
                <div class="test-info">
                    <h3>üìã Teste 1: Sele√ß√£o de Ordens</h3>
                    <ul>
                        <li>1. Abrir o frontend do PainelOS</li>
                        <li>2. Ir para a tela Board</li>
                        <li>3. Aplicar filtros para mostrar colunas de t√©cnicos</li>
                        <li>4. Clicar em uma ordem de servi√ßo em uma coluna de t√©cnico</li>
                        <li>5. Verificar se a ordem fica destacada (borda azul √† esquerda)</li>
                        <li>6. Verificar se aparece no console: "‚úÖ Selecionando ordem X para drag"</li>
                    </ul>
                </div>
                
                <div class="test-info">
                    <h3>üìã Teste 2: Drag and Drop</h3>
                    <ul>
                        <li>1. Com uma ordem selecionada, arrastar para a coluna "Em aberto"</li>
                        <li>2. Verificar se aparece no console: "üîÑ Iniciando drag da ordem X"</li>
                        <li>3. Verificar se aparece no console: "üéØ Drop detectado na coluna Em aberto"</li>
                        <li>4. Verificar se aparece no console: "‚úÖ Chamando handleReturnToOpen"</li>
                        <li>5. Verificar se a ordem aparece na coluna "Em aberto"</li>
                        <li>6. Verificar se a ordem desaparece da coluna do t√©cnico</li>
                    </ul>
                </div>
                
                <div class="test-info">
                    <h3>üìã Teste 3: M√∫ltiplas Ordens</h3>
                    <ul>
                        <li>1. Selecionar m√∫ltiplas ordens (Ctrl+Click)</li>
                        <li>2. Arrastar todas para "Em aberto"</li>
                        <li>3. Verificar se todas as ordens s√£o movidas corretamente</li>
                    </ul>
                </div>
                
                <button class="test-button" onclick="window.open('http://localhost:3000', '_blank')">
                    üåê Abrir Frontend
                </button>
                
                <button class="test-button secondary" onclick="openDevTools()">
                    üîß Abrir DevTools
                </button>
            </div>
            
            <div class="test-section">
                <h2>Status dos Testes</h2>
                
                <div class="test-info">
                    <h3>üîç Verifica√ß√µes Necess√°rias</h3>
                    <ul>
                        <li>
                            <strong>Sele√ß√£o visual funciona:</strong>
                            <span class="status-indicator status-warning">‚ö†Ô∏è Testar</span>
                        </li>
                        <li>
                            <strong>Drag and drop funciona:</strong>
                            <span class="status-indicator status-warning">‚ö†Ô∏è Testar</span>
                        </li>
                        <li>
                            <strong>Logs aparecem no console:</strong>
                            <span class="status-indicator status-warning">‚ö†Ô∏è Testar</span>
                        </li>
                        <li>
                            <strong>Ordens retornam para "Em aberto":</strong>
                            <span class="status-indicator status-warning">‚ö†Ô∏è Testar</span>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="test-section">
                <h2>Logs Esperados no Console</h2>
                
                <div class="debug-section">
                    <h4>üìã Sequ√™ncia de Logs para Drag and Drop Bem-sucedido</h4>
                    <div class="debug-code">
üîÑ Iniciando drag da ordem 123456 das colunas de t√©cnicos
‚úÖ Selecionando ordem 123456 para drag
üìã Dados de transfer√™ncia definidos: orderId=123456, fromTechnician=true
üéØ Drop detectado na coluna "Em aberto"
üìã Dados recebidos: orderId=123456, fromTechnician=true
‚úÖ Chamando handleReturnToOpen para ordem 123456
üîÑ handleReturnToOpen chamado para ordem 123456
                    </div>
                </div>
                
                <div class="debug-section">
                    <h4>‚ùå Logs de Erro Poss√≠veis</h4>
                    <div class="debug-code">
‚ùå Drop ignorado: fromTechnician=undefined, orderId=123456
‚ùå Drop ignorado: fromTechnician=false, orderId=123456
                    </div>
                </div>
            </div>
            
            <div class="test-section">
                <h2>Resultado Esperado</h2>
                
                <div class="test-info">
                    <h3>‚úÖ Cen√°rio de Sucesso</h3>
                    <ul>
                        <li><strong>Clique na ordem:</strong> Ordem fica destacada com borda azul</li>
                        <li><strong>In√≠cio do drag:</strong> Logs aparecem no console</li>
                        <li><strong>Drop na coluna "Em aberto":</strong> Ordem √© movida corretamente</li>
                        <li><strong>Estado final:</strong> Ordem aparece em "Em aberto" e desaparece da coluna do t√©cnico</li>
                        <li><strong>Feedback visual:</strong> Sele√ß√£o √© removida ap√≥s o drop</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        function openDevTools() {
            // Tentar abrir DevTools (funciona apenas em alguns navegadores)
            if (window.open) {
                window.open('', '_blank', 'width=800,height=600');
            }
            alert('Para abrir o DevTools:\n\nChrome/Edge: F12 ou Ctrl+Shift+I\nFirefox: F12 ou Ctrl+Shift+I\nSafari: Cmd+Option+I');
        }
        
        // Verificar se os servi√ßos est√£o rodando
        async function checkServices() {
            try {
                const backendResponse = await fetch('http://localhost:3002/api/health', { 
                    method: 'GET',
                    mode: 'no-cors'
                });
                console.log('‚úÖ Backend est√° rodando');
            } catch (error) {
                console.log('‚ùå Backend n√£o est√° acess√≠vel');
            }
            
            try {
                const frontendResponse = await fetch('http://localhost:3000', { 
                    method: 'GET',
                    mode: 'no-cors'
                });
                console.log('‚úÖ Frontend est√° rodando');
            } catch (error) {
                console.log('‚ùå Frontend n√£o est√° acess√≠vel');
            }
        }
        
        // Verificar servi√ßos ao carregar a p√°gina
        checkServices();
        
        // Simular logs de teste
        console.log('üß™ P√°gina de teste do drag and drop carregada');
        console.log('üìã Para testar:');
        console.log('1. Abra o frontend em http://localhost:3000');
        console.log('2. V√° para a tela Board');
        console.log('3. Aplique filtros para mostrar colunas de t√©cnicos');
        console.log('4. Teste o drag and drop das ordens');
        console.log('5. Verifique os logs no console do navegador');
    </script>
</body>
</html> 